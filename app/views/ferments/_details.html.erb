<section class="f-details-card mb-5">
  <div class="f-progress-banner p-4 rounded-top-4">

    <div class="f-progress-banner p-4 rounded-top-4">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <span class="status-pill <%= ferment.needs_review? ? 'urgent' : 'active' %>">
          <i class="bi <%= ferment.needs_review? ? 'bi-calendar-check' : 'bi-clock-history' %> me-2"></i>
          <%= ferment.needs_review? ? 'FINALIZADO' : 'EN PROCESO' %>
        </span>

        <% if current_user == ferment.user %>
          <%= link_to edit_user_ferment_path(current_user, ferment), class: "btn-edit-circle" do %>
            <i class="bi bi-pencil"></i>
          <% end %>
        <% end %>
      </div>

      <div class="progress-wrapper mb-2">
        <div class="d-flex justify-content-between mb-1 small">
          <span class="text-secondary">Progreso hasta el final</span>
          <span class="text-warning fw-bold">
            <%= ferment.needs_review? ? "Lleg贸 la fecha!" : "#{ferment.days_left} d铆as para el final" %>
          </span>
        </div>

        <div class="progress custom-progress">
          <div class="progress-bar progress-bar-striped progress-bar-animated <%= ferment.needs_review? ? 'bg-success' : 'bg-warning' %>"
              style="width: <%= ferment.progress_percentage %>%"></div>
        </div>

        <div class="d-flex justify-content-between mt-2 small">
          <span class="text-secondary">Desde: <%= ferment.formatted_start_date %></span>
          <span class="text-secondary">Hasta: <%= ferment.review_date.strftime("%d/%m/%Y") %></span>
        </div>
      </div>
    </div>

  </div>

  <div class="p-4">
    <div class="row g-4">

      <% [
        { label: " Descripci贸n", val: ferment.description, icon: "bi-info-circle" },
        { label: " Ingredientes", val: ferment.ingredients, icon: "bi-" },
        { label: " Instrucciones", val: ferment.instructions, icon: "bi-journal-text" },
        { label: " Tiempo estimado", val: ferment.fermentation_time, icon: "bi-clock" },
        { label: " Fecha Inicio", val: ferment.start_date&.strftime("%d/%m/%Y"), icon: "bi-calendar3" },
        { label: " Revisar cada", val: "#{ferment.revisar_fermentos} d铆as", icon: "bi-arrow-repeat" },
        { label: " Pr贸xima revisi贸n", val: ferment.review_date&.strftime("%d/%m/%Y"), icon: "bi-calendar-check" }
      ].each do |item| %>

        <div class="col-12">
          <label class="text-secondary text-uppercase small fw-bold mb-2 d-block">
            <i class="<%= item[:icon] %> text-warning me-2"></i><%= item[:label] %>
          </label>
          <div class="text-light-gray ps-4 border-start border-secondary opacity-75">
            <%= simple_format(item[:val]) %>
          </div>
        </div>

      <% end %>

    </div>

    <div id="photos-container-<%= ferment.id %>" class="mt-5 pt-4 border-top border-secondary border-opacity-25">
      <% if ferment.photos.any? %>
        <h6 class="text-center text-secondary small mb-4"> GALERA DEL PROCESO (<%= ferment.photos.count %> im谩genes)</h6>
        <%= render "ferments/photo_ferments", ferment: ferment %>
      <% else %>
        <%= render "ferments/empty_photos" %>
      <% end %>
    </div>
  </div>
</section>
