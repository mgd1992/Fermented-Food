<div class="container py-4" style="max-width: 600px;">
  <div class="card shadow-sm border-0">

    <!-- Header -->
    <div class="card-header bg-primary text-white text-center">
      <h2 class="mb-0">¡Hora de revisar tu fermento!</h2>
    </div>

    <!-- Ferment Info -->
    <div class="card-body text-center">

      <!-- Imagen -->
      <% if @ferment.photos.attached? %>
        <%= image_tag @ferment.photos.first.variant(resize_to_limit: [300, 200]), class: "img-fluid rounded mb-3" %>
      <% else %>
        <%= image_tag "placeholder.png", class: "img-fluid rounded mb-3", alt: "Fermento" %>
      <% end %>

      <!-- Nombre y fechas -->
      <h4 class="card-title mb-2"><%= @ferment.name %></h4>
      <p class="text-secondary mb-1">
        Comenzó el <strong><%= @ferment.start_date.strftime("%d/%m/%Y") %></strong><br>
        Tiempo de fermentación: <strong><%= @ferment.revisar_fermentos %> días</strong>
      </p>

      <!-- Progreso -->
      <%
        days_passed = (Time.current.to_date - @ferment.start_date).to_i
        progress = [((days_passed.to_f / @ferment.revisar_fermentos) * 100).round, 100].min
      %>
      <div class="progress mb-3" style="height: 20px;">
        <div class="progress-bar <%= progress < 100 ? 'bg-warning' : 'bg-success' %>" role="progressbar" style="width: <%= progress %>%;" aria-valuenow="<%= progress %>" aria-valuemin="0" aria-valuemax="100">
          <%= progress %>%
        </div>
      </div>

      <!-- Mensaje -->
      <p class="mb-3 text-dark">
        <%= progress < 100 ? "Tu fermento lleva #{days_passed} días. ¡Ya casi está listo!" : "¡Tu fermento debería estar listo para revisar hoy!" %>
      </p>

      <!-- Botón -->
      <%= link_to 'Ver fermento', ferment_url(@ferment), class: "btn btn-primary btn-lg" %>

    </div>

    <!-- Footer -->
    <div class="card-footer text-center text-muted small">
      Si ya revisaste este fermento, puedes ignorar este correo.
    </div>

  </div>
</div>
